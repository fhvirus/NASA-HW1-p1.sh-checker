#!/usr/bin/env bash

input_list=(
  # invalid
  ""
  "--key-generation"
  "--encrypt --public-exponent 34x7b --modulus ab92o testfile"
  "--encrypt --key-generation 0x79Ff 29327 testfile"
  "--encrypt -k 0x79FF 29327 testfile"
  "--encrypt -k 0x79FF 29327 testdir"
  "--encrypt 0x79FF 29327 testdir"
  "testfile"
  "--key-generation 2477 10xb23"
  "--key-generation 2477 0xb23g"
  "--key-generation 2477 0Xb23"
  "--key-generation 707981 906313 --encrypt --public-exponent 104857601 testfile"
  "--key-generation 707981 906313 --encrypt --private-exponent 104857601 testfile"
  "--decrypt --key-generation 0x79FF 29327 testfile"
  "--encrypt --decrypt --key-generation 0x79FF 29327 testfile"
  "--encrypt --public-exponent 65537 --private-exponent 4352849 --modulus 0x9565766135 testfile"
  "--decrypt --private-exponent 4352849 --public-exponent 65537 --modulus 8523649 testfile"
  "--encrypt --public-exponent 65537 --modulus 0x9565766135 --key-generation 2477 0xb23 testfile"
  # valid
  "--help"
  "--key-generation 2477 0xb23"
  "--key-generation 707981 906313"
  "--encrypt --public-exponent 65537 --modulus 641652384053 testfile"
  "--key-generation 707981 906313 --encrypt testfile"
  "--decrypt --private-exponent 64657547393 --modulus 641652384053 testfile"
  "--key-generation 2477 0xb23"
  "--encrypt --public-exponent 65537 --modulus 0x9565766135 testfile"
  "--encrypt --key-generation 0x79FF 29327 testfile"
  "--decrypt --private-exponent 4352849 --modulus 8523649 testfile"
  "--key-generation 7 11"
  "-h --key-generation 7 11"
  "--help -k"
  "-k --help"
  "--key-generation 0xb23g -h"
  "--encrypt --public-exponent 65537 --private-exponent 4352849 --modulus -h testfile"
  # examples
  "--key-generation 13052364169251182712529865530917160715901261508356286906018154708448386607095177886191121821309803457264690744541779713708076734887501915637090058452842683 11584458183371246231518993670207071606487618084225973680621631502269188790939395983847786431282010797563963081454324788582155559358721471061392643388381643"
  "--encrypt --public-exponent 65537 --modulus 151204566912823501566842779440920957488543013918510711316574222139674501133108472800655195046451384294797392815356344537253267426530643757826669685209287479208269621945653650056116185021370880028284539884888001719908275364741400178079153727857632256645617987836242311504874122811910055571624813462248244068169 testfile_en"
  "--encrypt --key-generation 13052364169251182712529865530917160715901261508356286906018154708448386607095177886191121821309803457264690744541779713708076734887501915637090058452842683 11584458183371246231518993670207071606487618084225973680621631502269188790939395983847786431282010797563963081454324788582155559358721471061392643388381643 testfile_en"
  "--decrypt --private-exponent 2475586314562149887563091114028841530512636433382089403583992864425755523075902029618429654772759438917216267007604218814909988993505664771778027255284273597435996764939196324912442493883297562401109426060381408684727335190947408333936087984538266633566575671799635418536078495474735850445694758274765250949 --modulus 151204566912823501566842779440920957488543013918510711316574222139674501133108472800655195046451384294797392815356344537253267426530643757826669685209287479208269621945653650056116185021370880028284539884888001719908275364741400178079153727857632256645617987836242311504874122811910055571624813462248244068169 testfile_de"
  # examples but hex
  "--encrypt --key-generation 13052364169251182712529865530917160715901261508356286906018154708448386607095177886191121821309803457264690744541779713708076734887501915637090058452842683 11584458183371246231518993670207071606487618084225973680621631502269188790939395983847786431282010797563963081454324788582155559358721471061392643388381643 testfile_en_hex"
  "--decrypt --private-exponent 2475586314562149887563091114028841530512636433382089403583992864425755523075902029618429654772759438917216267007604218814909988993505664771778027255284273597435996764939196324912442493883297562401109426060381408684727335190947408333936087984538266633566575671799635418536078495474735850445694758274765250949 --modulus 151204566912823501566842779440920957488543013918510711316574222139674501133108472800655195046451384294797392815356344537253267426530643757826669685209287479208269621945653650056116185021370880028284539884888001719908275364741400178079153727857632256645617987836242311504874122811910055571624813462248244068169 testfile_de_hex"
)

for i in ${!input_list[@]}; do
  input=${input_list[$i]}
  start_time=`date +%s.%N`
  output=$(./p1.sh ${input} 2>&1)
  exit_code=$?
  end_time=`date +%s.%N`
  run_time=$(bc -l <<< "$end_time - $start_time")
  title="----------------- Input ${i}: ${input} "
  color=34
  if [[ $i -le 17 ]]; then color=31; fi
  echo -e "\033[1;${color}m${title}\033[0m"
  echo "${output}"
  echo ""
  echo "Your exit code: ${exit_code}" # , time elapsed: ${run_time}s"
  echo ""
done
